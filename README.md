# MAPPLE APP

Sales application for Mapple (Technitoit / Europe Energie / MisterToiture).

## How to Use (Development environment)

**Install dependencies**

Go to project root and execute the following command in console to get the required dependencies:

```
flutter pub get
```

**Build stores**

This project uses `inject` library that works with code generation, execute the following command to generate files:

```
dart run build_runner build -d
```

or watch command in order to keep the source code synced automatically:

```
dart run build_runner watch -d
```

### Hide Generated Files

In Visual Studio Code, navigate to `Preferences` -> `Settings` and search for `Files:Exclude`. Add the following patterns:

```
**/*.inject.summary
**/*.inject.dart
**/*.g.dart
```

### Libraries & Tools Used

- [Dio](https://github.com/flutterchina/dio)
- [MobX](https://github.com/mobxjs/mobx.dart) (to connect the reactive data of your application with the UI)
- [Provider](https://github.com/rrousselGit/provider) (State Management)
- [Validation](https://github.com/dart-league/validators)
- [Logging](https://github.com/zubairehman/Flogs)
- [Notifications](https://github.com/AndreHaueisen/flushbar)
- [Json Serialization](https://github.com/dart-lang/json_serializable)
- [Dependency Injection](https://github.com/fluttercommunity/get_it)
- [Firebase Libraries](https://firebase.google.com/docs/flutter/setup)

### Folder Structure

Here is the folder structure we have been using in this project

```
lib/
|- constants/
|- data/
|- di/
|- domains/
|- models/
|- screens/
|- stores/
|- utils/
|- app.dart
|- firebase_options.dart
|- main.dart
```

Now, lets dive into the lib folder which has the main code for the application.

```
1- constants - All the application level constants are defined in this directory with-in their respective files. This directory contains the constants for `theme`, `dimentions`, `preferences` and `strings`.
2- data - Contains the data layer, includes directories for local, network and shared pref/cache.
3- di - Contains the configurations for dependencies injection.
4- domains - Permits the separation of code into domains.
5- models - Contains all the models.
6- screens — Contains all the screens.
7- stores - Contains common store(s) for state-management of the application, to connect the reactive data with the UI.
8- utils — Contains the utilities/common functions of your application.
8- app.dart — Contains the first widget of the app.
8- firebase_options.dart — Contains firebase configuration, automatically generated by Flutterfire.
11- main.dart - This is the starting point of the application. All the application level configurations are defined in this file i.e, theme, routes, title, orientation etc.
```

### Enable pre-commit hook

To activate the pre-commit hook you need to run the following command:

```
./utils/install_pre_commit.sh
```

### Generate configuration file for Swift

To generate configuration file (.xcconfig) from .env file, run the following command :

```
./utils/transform_dotenv_to_xcconfig.sh
```

### Tags

#### Dev build based on Firebase staging

In order to generate a development build based on the firebase staging instance, the name of the tag must respect this format:

```
1.0.0-1
```

- '1.0.0' corresponds to the version.
- '\-' is a separator.
- '1' is the build number.

#### Dev build based on Firebase prod

To generate a development build based on the production Firebase instance, the tag name must be in the format:

```
1.0.0-2-prod
```

- '1.0.0' corresponds to the version.
- '\-' is a separator.
- '2' is the build number.
- '-prod' is the flag to indicate to use the production Firebase instance.

#### Production build

To generate a production build, the name bust be in the format:

```
1.0.0
```

- This corresponds to the version.
- The build number will be the job ID on Gitlab CI/CD.

## Price wording

- Prix unitaire → price
- Prix total = price \* quantity → total
- Prix unitaire brut → grossPrice
- Prix unitaire net = prix unitaire brut avec remise → netPrice
- TTC → inclTax
- HT → exclTax

E.g. :

- Total brut HT → totalGrossExclTax
- Total avec remise TTC → Total net TTC → totalNetInclTax
- Prix unitaire avec remise TTC → netPriceInclTax
